# -*- coding: utf-8 -*-

from os.path import abspath, dirname

project_dir = dirname(dirname(abspath(__file__)))

from multiprocessing import cpu_count

cc = cpu_count()
cpus = 3 if cc <= 4 else 7 if cc <= 8 else 16
# cpus = 30
print('{} cpus avaliable, use {}'.format(cc, cpus))

markets = {
    'sz': {'id': 0, 'name': 'sz', 'filter': lambda x: True if x.startswith('00') or x.startswith('30') else False},
    'sh': {'id': 1, 'name': 'sh', 'filter': lambda x: True if x.startswith('60') else False},
    'hk': {'id': 31, 'name': 'hk'},
    'usa': {'id': 74, 'name': 'usa'}
}
categories = {
    'index_month': 6,
    'index_week': 5,
    'index_day': 4,
    'index_min5': 0,
    'index_min15': 1,
    'index_min30': 2,
    'index_min60': 3,
    'kline_month': 6,
    'kline_week': 5,
    'kline_day': 4,
    'kline_min1': 8,
    'kline_min1_old': 8,
    'kline_min5': 0,
    'kline_min15': 1,
    'kline_min30': 2,
    'kline_min60': 3,
}

index_dict = {
    'sz': ['399001', '399106', '399005', '399101', '399006', '399102', '399303'],
    # 深圳 深证成指（399001） 深圳综指（399106）中小板指（399005）中小板综（399101）创业板指（399006）创业板综（399102）
    'sh': ['000001', '000300', '000905', '000016'],  # 上海 上证指数（000001） 沪深500（000300）中证500（000905） 上证50（000016）
}


def detect_market_id(stock_code):
    if markets['sh']['filter'](stock_code):
        return markets['sh']['id']
    elif markets['sz']['filter'](stock_code):
        return markets['sz']['id']
    else:
        return None


index_dict['sh'].extend([
    "880201",
    "880202",
    "880203",
    "880204",
    "880205",
    "880206",
    "880207",
    "880208",
    "880209",
    "880210",
    "880211",
    "880212",
    "880213",
    "880214",
    "880215",
    "880216",
    "880217",
    "880218",
    "880219",
    "880220",
    "880221",
    "880222",
    "880223",
    "880224",
    "880225",
    "880226",
    "880227",
    "880228",
    "880229",
    "880230",
    "880231",
    "880232",
    "880301",
    "880302",
    "880303",
    "880305",
    "880306",
    "880307",
    "880308",
    "880310",
    "880311",
    "880312",
    "880313",
    "880318",
    "880319",
    "880320",
    "880321",
    "880324",
    "880325",
    "880326",
    "880327",
    "880328",
    "880329",
    "880330",
    "880335",
    "880336",
    "880337",
    "880338",
    "880339",
    "880340",
    "880344",
    "880345",
    "880346",
    "880347",
    "880348",
    "880350",
    "880351",
    "880355",
    "880360",
    "880361",
    "880362",
    "880363",
    "880364",
    "880366",
    "880367",
    "880368",
    "880369",
    "880372",
    "880373",
    "880374",
    "880375",
    "880380",
    "880381",
    "880382",
    "880383",
    "880387",
    "880390",
    "880391",
    "880392",
    "880393",
    "880394",
    "880398",
    "880399",
    "880400",
    "880401",
    "880402",
    "880403",
    "880406",
    "880407",
    "880408",
    "880409",
    "880410",
    "880411",
    "880412",
    "880413",
    "880414",
    "880418",
    "880419",
    "880420",
    "880421",
    "880422",
    "880423",
    "880424",
    "880425",
    "880426",
    "880430",
    "880431",
    "880432",
    "880437",
    "880438",
    "880439",
    "880440",
    "880441",
    "880442",
    "880443",
    "880444",
    "880445",
    "880446",
    "880447",
    "880448",
    "880452",
    "880453",
    "880454",
    "880455",
    "880456",
    "880459",
    "880460",
    "880461",
    "880462",
    "880463",
    "880464",
    "880465",
    "880466",
    "880467",
    "880468",
    "880471",
    "880472",
    "880473",
    "880474",
    "880476",
    "880477",
    "880478",
    "880482",
    "880483",
    "880484",
    "880485",
    "880486",
    "880489",
    "880490",
    "880491",
    "880492",
    "880493",
    "880494",
    "880497",
    "880501",
    "880502",
    "880503",
    "880504",
    "880505",
    "880506",
    "880507",
    "880511",
    "880513",
    "880515",
    "880516",
    "880519",
    "880520",
    "880521",
    "880522",
    "880523",
    "880524",
    "880525",
    "880526",
    "880527",
    "880528",
    "880529",
    "880530",
    "880531",
    "880532",
    "880533",
    "880534",
    "880535",
    "880536",
    "880537",
    "880538",
    "880539",
    "880540",
    "880541",
    "880542",
    "880543",
    "880544",
    "880545",
    "880546",
    "880547",
    "880548",
    "880549",
    "880550",
    "880551",
    "880552",
    "880553",
    "880554",
    "880556",
    "880557",
    "880558",
    "880559",
    "880560",
    "880562",
    "880563",
    "880564",
    "880565",
    "880566",
    "880567",
    "880568",
    "880569",
    "880570",
    "880571",
    "880572",
    "880573",
    "880574",
    "880575",
    "880576",
    "880577",
    "880578",
    "880579",
    "880580",
    "880581",
    "880582",
    "880583",
    "880584",
    "880585",
    "880586",
    "880587",
    "880588",
    "880589",
    "880590",
    "880591",
    "880592",
    "880593",
    "880594",
    "880595",
    "880596",
    "880597",
    "880598",
    "880599",
    "880600",
    "880601",
    "880602",
    "880603",
    "880604",
    "880605",
    "880606",
    "880607",
    "880608",
    "880609",
    "880610",
    "880612",
    "880613",
    "880614",
    "880615",
    "880616",
    "880617",
    "880618",
    "880619",
    "880620",
    "880621",
    "880622",
    "880623",
    "880624",
    "880625",
    "880626",
    "880627",
    "880628",
    "880629",
    "880630",
    "880631",
    "880632",
    "880633",
    "880634",
    "880635",
    "880636",
    "880637",
    "880638",
    "880639",
    "880640",
    "880641",
    "880642",
    "880643",
    "880644",
    "880645",
    "880646",
    "880647",
    "880648",
    "880649",
    "880650",
    "880651",
    "880652",
    "880653",
    "880654",
    "880655",
    "880656",
    "880657",
    "880658",
    "880659",
    "880660",
    "880661",
    "880662",
    "880663",
    "880664",
    "880665",
    "880666",
    "880667",
    "880668",
    "880669",
    "880670",
    "880671",
    "880672",
    "880673",
    "880674",
    "880675",
    "880676",
    "880677",
    "880678",
    "880679",
    "880680",
    "880681",
    "880682",
    "880683",
    "880684",
    "880685",
    "880801",
    "880802",
    "880803",
    "880804",
    "880805",
    "880806",
    "880807",
    "880808",
    "880809",
    "880821",
    "880823",
    "880824",
    "880826",
    "880827",
    "880829",
    "880833",
    "880834",
    "880835",
    "880836",
    "880837",
    "880842",
    "880843",
    "880844",
    "880845",
    "880846",
    "880847",
    "880848",
    "880849",
    "880850",
    "880851",
    "880852",
    "880853",
    "880854",
    "880855",
    "880856",
    "880857",
    "880858",
    "880859",
    "880860",
    "880861",
    "880862",
    "880863",
    "880864",
    "880865",
    "880866",
    "880867",
    "880868",
    "880869",
    "880870",
    "880871",
    "880872",
    "880873",
    "880874",
    "880875",
    "880876",
    "880877",
    "880878",
    "880879",
    "880880",
    "880881",
    "880882",
    "880883",
    "880884",
    "880885",
    "880886",
    "880887",
    "880889",
    "880890",
    "880901",
    "880902",
    "880903",
    "880904",
    "880905",
    "880906",
    "880907",
    "880908",
    "880909",
    "880910",
    "880911",
    "880912",
    "880913",
    "880915",
    "880916",
    "880917",
    "880918",
    "880919",
    "880920",
    "880921",
    "880922",
    "880923",
    "880925",
    "880926",
    "880927",
    "880928",
    "880929",
    "880930",
    "880931",
    "880932",
    "880933",
    "880935",
    "880936",
    "880937",
    "880938",
    "880939",
    "880940",
    "880941",
    "880942",
    "880943",
    "880944",
    "880945",
    "880946",
    "880947",
    "880948",
    "880949",
    "880950",
    "880951",
    "880952",
    "880953",
    "880954",
    "880981",
    "880982",
    "880983",
    "880984",
    "880985",
    "880986",
    "880987",
    "880988",
    "880989",
    "880990",
    "880991",
    "880992",
    "880993"
])

unit_conversion = {
    'month': 1,
    'week': 1,
    'day': 1,
    'min60': 4,
    'min30': 8,
    'min15': 16,
    'min5': 48,
    'min1': 240,
    'min1_old': 240
}

from . import markets, categories, index_dict, project_dir, detect_market_id, unit_conversion
